stages:
  - coverage
  - docs

coverage:
  stage: coverage
  coverage: '/Statements.*?(\d+(?:\.\d+)?)/'
  only:
    - master
  script:
    - rm -rf package-lock.json
    - npm install
    - npm run coverage
    - ls
    - mkdir -p ${EE_REPORT}/${CI_PROJECT_PATH}/coverage/
    - cp -rf coverage/lcov-report/*/ ${EE_REPORT}/${CI_PROJECT_PATH}/coverage/ -f
    - ls ${EE_REPORT}/${CI_PROJECT_PATH}/coverage/
  artifacts:
    paths:
      - coverage/

docs:
  stage: docs
  only:
    - master
  script:
    - npm run docs:build
    - ls
    - mkdir -p ${EE_REPORT}/${CI_PROJECT_PATH}/docs/
    - cp -rf docs/.vuepress/dist/* ${EE_REPORT}/${CI_PROJECT_PATH}/docs/
    - ls ${EE_REPORT}/${CI_PROJECT_PATH}/docs/
